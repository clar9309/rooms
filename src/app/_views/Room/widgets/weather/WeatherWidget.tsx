"use client";
import { ExtendedRoom } from "@/app/_models/room";
import Link from "next/link";
import { useSession } from "next-auth/react";
import Weather from "./Weather";

interface WeatherWidgetProps {
  roomData: ExtendedRoom;
  weatherData?: any;
}

function WeatherWidget({ roomData, weatherData }: WeatherWidgetProps) {
  const { data: session } = useSession();

  return (
    <div className="bg-primary rounded-xl">
      {roomData.location ? (
        <Weather weatherData={weatherData} locationData={roomData.location} />
      ) : (
        <>
          {roomData.admin_fk === session?.user.id ? (
            <Link
              href={`
            settings?tab=3`}
              className="p-5 w-full grid transition rounded-xl hover:bg-opacity-10 hover:bg-grey"
            >
              <p className="text-h3 mb-2 mt-1">No location added</p>
              <p className="text-base text-darkGrey">
                Add location in your room settings to get weather
              </p>
              <svg
                className="ml-auto"
                xmlns="http://www.w3.org/2000/svg"
                width="32"
                height="32"
                viewBox="0 0 32 32"
                fill="none"
              >
                <path
                  d="M16 3.99967H16.4107C16.5476 3.99967 16.684 4.00501 16.82 4.01567V5.35567C16.684 5.3459 16.5507 5.33523 16.42 5.32367C16.2903 5.31301 16.1503 5.30767 16 5.30767C13.6703 5.30767 11.7329 6.10101 10.188 7.68767C8.64314 9.27434 7.87114 11.2877 7.87203 13.7277C7.87203 15.3739 8.60003 17.325 10.056 19.581C11.5129 21.8361 13.4943 24.0539 16 26.2343C18.4711 24.0886 20.4311 21.909 21.88 19.6957C23.3271 17.4823 24.0765 15.553 24.128 13.9077V13.8463H25.4614V13.9077C25.4276 15.1859 25.1014 16.4748 24.4827 17.7743C23.8649 19.073 23.1267 20.3041 22.268 21.4677C21.4094 22.6321 20.5169 23.6877 19.5907 24.6343C18.6654 25.5801 17.8778 26.3508 17.228 26.9463C17.0583 27.1001 16.8654 27.2157 16.6494 27.293C16.4325 27.3695 16.216 27.4077 16 27.4077C15.7911 27.4077 15.5823 27.3735 15.3734 27.305C15.1654 27.2366 14.9734 27.1255 14.7974 26.9717C13.8489 26.1006 12.8876 25.1295 11.9134 24.0583C10.9383 22.9881 10.0529 21.8801 9.25736 20.7343C8.46181 19.5877 7.80981 18.4175 7.30136 17.2237C6.79292 16.0299 6.5387 14.8646 6.5387 13.7277C6.5387 10.9072 7.45692 8.58101 9.29336 6.74901C11.1307 4.91612 13.3663 3.99967 16 3.99967ZM16.004 15.6397C16.5978 15.6397 17.1045 15.4286 17.524 15.0063C17.9436 14.5841 18.1534 14.0761 18.1534 13.4823C18.1534 12.8886 17.9423 12.3819 17.52 11.9623C17.0969 11.5428 16.5889 11.333 15.996 11.333C15.4031 11.333 14.8965 11.5446 14.476 11.9677C14.0565 12.3899 13.8467 12.8979 13.8467 13.4917C13.8467 14.0855 14.0578 14.5921 14.48 15.0117C14.9031 15.4312 15.4111 15.641 16.004 15.641M24 6.66634V9.99967C24 10.189 24.064 10.3472 24.192 10.4743C24.32 10.6015 24.4783 10.6655 24.6667 10.6663C24.8551 10.6663 25.0134 10.6023 25.1414 10.4743C25.2694 10.3472 25.3334 10.189 25.3334 9.99967V6.66634H28.6667C28.856 6.66634 29.0143 6.60234 29.1414 6.47434C29.2685 6.34634 29.3325 6.18767 29.3334 5.99834C29.3334 5.8099 29.2694 5.65167 29.1414 5.52367C29.0143 5.39656 28.856 5.33301 28.6667 5.33301H25.3334V1.99967C25.3334 1.81034 25.2694 1.65212 25.1414 1.52501C25.0134 1.39701 24.8551 1.33301 24.6667 1.33301C24.4783 1.33301 24.32 1.39701 24.192 1.52501C24.064 1.65301 24 1.81123 24 1.99967V5.33301H20.6667C20.4774 5.33301 20.3191 5.39701 20.192 5.52501C20.064 5.65301 20 5.81167 20 6.00101C20 6.18945 20.064 6.34767 20.192 6.47567C20.32 6.60279 20.4783 6.66634 20.6667 6.66634H24Z"
                  fill="#EAEAEB"
                />
              </svg>
            </Link>
          ) : (
            <div className="p-5">
              <p className="text-h3 mb-2">No location added</p>
              <p className="text-base text-darkGrey">
                {"Only owner of the room can update a room's location"}
              </p>
            </div>
          )}
        </>
      )}
    </div>
  );
}

export default WeatherWidget;
